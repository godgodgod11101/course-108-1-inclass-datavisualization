---
title: "每週一圖作業"
output: html_document
params:
  組員: ["王正評"]  
  學號: ["710761105"]
---

#### 環境設定

以下為老師執行時一定會存在的環境設定
```{r basic setup, message=FALSE, echo=TRUE, eval=T}
library(dplyr); library(stringr); library(ggplot2); library(plotly); library(lubridate); library(readr); library(tidyr); library(showtext)

font_add("QYuan","cwTeXQYuan-Medium.ttf") # 新增字體
showtext_auto(enable=TRUE) #啟用字體
theme_set(theme_classic())
knitr::opts_chunk$set(out.width='80%', fig.asp=.75, fig.align='center', fig.showtext=T)
```

#### 資料處理

此部份在做：

  * 原始Rda資料引入（即引入**dataList**物件）；
  
  * 資料清理成作圖用graphData物件。

請將你最原始的資料連同作業一起上傳到作業上傳網址：  
  * 若「原始資料為網頁下載」，且下載指令寫在data cleaning chunk裡的話，可以不用上傳「資料」。  
  * 若原始資料有很多個檔案，請先引入成data frame並存在「一個」.Rda檔裡上傳（如`example_data.Rda`檔）。  

資料檔引入到進入作圖前的資料處理請寫在下面區塊，分二部份：

  * 資料處理  
  * 作圖用資料物件生成(最後形成作圖資料物件graphData)
  
```{r data cleaning, echo=TRUE, eval=T}

load("godFile.Rda")

graphData <- list()

East_Asia_Pacific %>%
  mutate(
    rigion = "EastAsiaPacific"
  ) %>% 
  na.omit() %>% 
  filter(
    `2017 [YR2017]` != ".."
  )-> 
  graphData$East_Asia_Pacific
  
North_America %>%
  mutate(
    rigion = "NorthAmerica"
  ) %>% 
  na.omit() %>% 
  filter(
    `2017 [YR2017]` != ".."
  ) -> 
  graphData$North_America

Europe_Central_Asia %>%
  mutate(
    rigion = "EuropeCentralAsia"
  ) %>% 
  na.omit() %>% 
  filter(
    `2017 [YR2017]` != ".."
  ) -> 
  graphData$Europe_Central_Asia

bind_rows(
  graphData$East_Asia_Pacific, 
  graphData$Europe_Central_Asia, 
  graphData$North_America
) ->
  graphData$AEA_bindThree

graphData$AEA_bindThree %>%
  select(-`Series Name`, -`Series Code`) %>%
  transmute(
    國名 = `Country Name`, 
    國家代碼 = `Country Code`, 
    區域 = as.factor(rigion), 
    `GNP per capita(current US$)` = as.double(`2017 [YR2017]`)
  ) ->
  graphData$AEA_bindThree_eV1

graphData$AEA_bindThree_eV1 %>% 
  filter(
    國家代碼 %in% c(
    "VNM", "TJK", "CHE", "CHN", "KOR", "JPN", "USA", "GBR", "SGP", "TUR", "AUS", "ESP"
    )
  ) -> 
  graphData$AEA_bindThree_eV2

```

#### 繪圖程式

```{r graph, echo=T, eval=T}

graphData$AEA_bindThree_eV1 %>% 
  ggplot() + 
  geom_point(
    aes(
      x = 區域, 
      y = `GNP per capita(current US$)`
    ), 
    shape = 124, 
    size = 10, 
    color = "#00BFFF", 
    alpha = 0.2
  ) +
  geom_point(
    data = graphData$AEA_bindThree_eV2, 
    aes(
      x = 區域, 
      y = `GNP per capita(current US$)`
    ), 
    shape = 124, 
    size = 10, 
    color = "#00BFFF", 
  ) + 
  geom_text(
    data = graphData$AEA_bindThree_eV2, 
    aes(
      x = 區域, 
      y = `GNP per capita(current US$)`, 
      label = 國名
    ), 
    size = 3, 
    vjust = -3, 
    hjust = 0.6
  ) + 
  coord_flip() ->
  graphData$godplot_base

graphData$godplot_base + 
  theme_bw() + 
  theme(
    panel.border = element_blank(), 
    panel.grid.minor = element_blank() 
  ) + 
  theme(
    axis.ticks = element_blank(), 
    axis.title = element_blank()
  ) + 
  scale_x_discrete(
    limits = c("EastAsiaPacific", "NorthAmerica", "EuropeCentralAsia"), 
    labels = c("East Asia & Pacific", "North America", "Europe & Central Asia")
  ) + 
  scale_y_continuous(
    labels = function(x) x/1000
  ) -> 
  graphData$godplot_1

graphData$godplot_1 + 
  labs(
    title = "GNP per capita 2017", 
    subtitle = "Source: World Bank", 
    caption = "US$ thousand"
  ) + 
  theme(
    plot.title = element_text(face = "bold"), 
    plot.subtitle = element_text(color = "#AAAAAA"), 
    plot.caption = element_text(color = "#666666")
  ) -> 
  graphData$godplot_eV

graphData$godplot_eV
  
```

#### 設計說明
說明想傳達的訊息（必要）及設計想法（非必要）。寫在***之後

*** 
該圖呈現2017年亞洲、歐洲、北美、大洋洲各國之人均GNP，其中

<ol>
  <li>歐洲、亞洲國家人均GNP差異很大</li>
  <li>北美地區人均GNP偏高</li>
</ol>

